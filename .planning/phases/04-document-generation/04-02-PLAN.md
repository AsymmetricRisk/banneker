---
phase: 04-document-generation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - templates/agents/banneker-writer.md
autonomous: true

must_haves:
  truths:
    - "Writer agent generates project-specific markdown documents with zero placeholder content"
    - "Writer agent uses term registry for consistent naming across all output"
    - "Writer agent cites DEC-XXX decision IDs where architectural choices are discussed"
    - "Writer agent self-validates output before returning to architect"
  artifacts:
    - path: "templates/agents/banneker-writer.md"
      provides: "Writer sub-agent instructions for generating individual planning documents"
      min_lines: 200
      contains: "banneker-writer"
  key_links:
    - from: "templates/agents/banneker-writer.md"
      to: ".banneker/survey.json"
      via: "receives survey data from architect"
      pattern: "survey_data"
    - from: "templates/agents/banneker-writer.md"
      to: ".banneker/architecture-decisions.json"
      via: "receives decisions from architect for citation"
      pattern: "DEC-"
    - from: "templates/agents/banneker-writer.md"
      to: ".banneker/documents/"
      via: "writes generated document to output directory"
      pattern: ".banneker/documents/"
---

<objective>
Create the banneker-writer sub-agent that generates individual planning documents from survey data.

Purpose: The writer agent is the content generation specialist. It receives a document type, survey data, decisions, term registry, document structure, and dependency documents from the architect, then produces a single project-specific markdown document with zero placeholders, consistent naming, and decision citations. It self-validates before returning.

Output: One file — the writer agent markdown (templates/agents/banneker-writer.md) containing complete generation and validation instructions for all 10 document types.
</objective>

<execution_context>
@/home/daniel/.claude/get-shit-done/workflows/execute-plan.md
@/home/daniel/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-document-generation/04-RESEARCH.md

# Existing agent pattern to follow
@templates/agents/banneker-surveyor.md

# Sample output documents showing target quality and structure
@.banneker/documents/TECHNICAL-SUMMARY.md
@.banneker/documents/STACK.md
@.banneker/documents/INFRASTRUCTURE-ARCHITECTURE.md
@.banneker/documents/DEVELOPER-HANDBOOK.md

# Sample data the writer will consume
@.banneker/survey.json
@.banneker/architecture-decisions.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create banneker-writer.md sub-agent</name>
  <files>templates/agents/banneker-writer.md</files>
  <action>
Create `templates/agents/banneker-writer.md` — the writer sub-agent that generates individual planning documents.

**YAML frontmatter** (follow banneker-surveyor.md pattern exactly):
```yaml
---
name: banneker-writer
description: "Sub-agent that generates individual project-specific planning documents from survey data. Receives document type, survey data, decisions, term registry, and dependencies from the architect agent. Self-validates for zero placeholders, naming consistency, and decision citations."
---
```

**Markdown body** must include these sections:

**1. Role Introduction:**
You are the Banneker Writer. You generate a single project-specific planning document. You are spawned by the banneker-architect agent, which provides you with everything you need: the document type, survey data, architecture decisions, a term registry of canonical names, the document structure (section headings), and any dependency documents you should reference. Your job is to produce a complete, project-specific markdown document with zero generic content.

**2. Inputs (received from architect via Task tool):**
- `document_type`: Which document to generate (e.g., "TECHNICAL-SUMMARY", "STACK", etc.)
- `survey_data`: Complete survey.json content
- `decisions`: Complete architecture-decisions.json content
- `term_registry`: Canonical names — projectName, actors[], technologies[], entities[], integrations[]
- `document_structure`: Section headings and purpose for this document type (from document-catalog.md)
- `dependencies`: Content of already-generated documents this one may reference (e.g., STACK.md content when writing TECHNICAL-DRAFT.md)

**3. Output:**
Single markdown file at `.banneker/documents/{DOCUMENT_TYPE}.md`

**4. Generation Workflow:**

**Phase 1: Planning (before writing anything)**
- Review document_structure to understand required sections
- Extract relevant data from survey_data for each section
- Identify which decisions from decisions to cite (match decision.choice or decision.question to section topics)
- If dependencies provided, note key content to reference or align with
- Create a mental outline mapping: section → survey data → decisions → dependency references

**Phase 2: Generation (write the document)**
Write section by section following document_structure:
- Use `term_registry` for ALL names — project name, actor names, technology names, entity names. Use the EXACT strings from the registry. Do not abbreviate (e.g., if registry says "PostgreSQL", never write "Postgres"). Do not use synonyms (e.g., if registry says "Developer", never write "Engineer" or "Contributor").
- Cite decision IDs inline: When discussing an architectural choice that has a DEC-XXX record, include the citation in parentheses. Example: "The project uses PostgreSQL for relational data storage (DEC-003)."
- Be project-specific: Every sentence should reference actual project details from survey_data. Never use generic examples like "e.g., React" or "such as PostgreSQL". Use the actual technologies from the survey.
- Reference dependencies naturally: "See STACK.md for detailed technology rationale" or "As described in INFRASTRUCTURE-ARCHITECTURE.md, the deployment topology uses..."
- If information is genuinely missing from survey_data for a section, write: "This section requires additional information not captured in the current survey. Run `/banneker:survey` to update." Do NOT insert `[TODO]`, `TBD`, or any placeholder marker.

**Phase 3: Self-Validation (before returning)**
Validate your own output against these rules:

Placeholder scan (REQ-DOCS-003):
- Search the generated document for these patterns: `[TODO`, `[PLACEHOLDER`, `TBD`, `FIXME`, `XXX`
- Search for template markers: `<!-- BANNEKER:`, `{{`, `{%`, `<variable_name>` (angle-bracket variables)
- Search for generic examples: phrases like "e.g.," followed by a technology name, "such as" followed by a tool name, "for example" followed by a framework
- If ANY placeholder or template marker found: STOP. Remove it and replace with project-specific content from survey_data, then re-validate.

Term consistency check (REQ-DOCS-004):
- Read through every mention of the project name — must match term_registry.projectName exactly
- Read through every actor reference — must match one of term_registry.actors exactly
- Read through technology names — must match term_registry.technologies
- Read through entity/data model names — must match term_registry.entities
- If ANY mismatch found: correct it to match the registry, then re-validate.

Decision citation check (REQ-DOCS-005):
- For each DEC-XXX reference in the document, verify the ID exists in the decisions input
- If a citation references a non-existent decision ID: remove the citation or correct the ID

**5. Document-Specific Generation Guidance:**

Provide detailed guidance for each of the 10 document types. For each, specify:
- What survey data maps to which sections
- What tone and depth to use
- What decisions are most likely to be cited

**TECHNICAL-SUMMARY.md:**
- Sections: Project Overview, Core Value Proposition, Actors and Roles, Technology Stack, Key Architectural Decisions, Constraints, System Boundaries
- Tone: Executive summary — clear, concise, factual
- Data mapping: project.name → title, project.pitch → overview, actors[] → actor table, backend.stack → tech stack, decisions → key decisions table
- Likely citations: All major DEC-XXX entries

**STACK.md:**
- Sections: Stack Overview (table), each technology category in detail, Hosting, Integrations, Constraints, Decision Rationale
- Tone: Technical reference — detailed, specific, rationale-driven
- Data mapping: backend.stack → categories, backend.hosting → hosting section, backend.integrations → integrations table, decisions → rationale columns
- Likely citations: Technology choice decisions (database, framework, hosting, etc.)

**INFRASTRUCTURE-ARCHITECTURE.md:**
- Sections: System Topology, Data Flow, Deployment Architecture, Security Boundaries, Scaling Considerations, Monitoring and Observability
- Tone: Architecture document — technical depth, diagrams described in prose
- Data mapping: backend.hosting → deployment, backend.data_stores → data layer, backend.integrations → external systems, walkthroughs → data flow descriptions
- Likely citations: Infrastructure and hosting decisions

**TECHNICAL-DRAFT.md:**
- Sections: Data Model, API Surface, Authentication/Authorization, Business Logic, Error Handling Strategy
- Tone: Engineering specification — precise, implementable
- Data mapping: backend.data_stores → data model, walkthroughs → API endpoints and business logic, rubric_coverage → security/auth sections
- Likely citations: Database, API, auth decisions

**DEVELOPER-HANDBOOK.md:**
- Sections: Getting Started, Development Environment, Architecture Overview, Code Organization, Testing Strategy, Deployment Process, Contributing Guidelines
- Tone: Onboarding guide — instructional, step-by-step
- Data mapping: backend.stack → environment setup, walkthroughs → architecture overview, rubric_coverage → testing section, backend.hosting → deployment
- Likely citations: Tool and process decisions

**DESIGN-SYSTEM.md:**
- Sections: Design Principles, Component Hierarchy, Layout System, Typography, Color System, Interaction Patterns, Responsive Strategy
- Tone: Design reference — visual vocabulary
- Data mapping: project.type → design context, walkthroughs with UI → interaction patterns, actors → user-facing design considerations
- Likely citations: Frontend framework decisions

**PORTAL-INTEGRATION.md:**
- Sections: Integration Overview, each integration in detail (auth flow, data format, error handling, rate limits), Integration Testing Strategy
- Tone: Integration guide — precise, contract-focused
- Data mapping: backend.integrations → one section per integration, walkthroughs involving external systems → flow descriptions
- Likely citations: Integration and API decisions

**OPERATIONS-RUNBOOK.md:**
- Sections: Infrastructure Overview, Deployment Procedures, Monitoring and Alerting, Incident Response, Scaling Procedures, Backup and Recovery
- Tone: Operations manual — procedural, actionable
- Data mapping: backend.hosting → infrastructure overview, backend.data_stores → backup procedures, rubric_coverage → monitoring items
- Likely citations: Hosting and infrastructure decisions

**LEGAL-PLAN.md:**
- Sections: Compliance Requirements, Data Privacy, Terms of Service, Licensing, Regulatory Considerations
- Tone: Legal planning — structured, requirement-focused
- Data mapping: rubric_coverage.covered LEGAL-* items → specific compliance sections, backend.data_stores → data privacy considerations
- Likely citations: Compliance-related decisions

**CONTENT-ARCHITECTURE.md:**
- Sections: Content Model, Content Types, Editorial Workflow, Publishing Pipeline, Content Governance
- Tone: Content strategy — structured, workflow-oriented
- Data mapping: walkthroughs with content flows → editorial workflow, backend.data_stores with content entities → content model
- Likely citations: CMS or content-related decisions

**6. Quality Rules (Non-Negotiable):**
- Every sentence must contain project-specific information. If you find yourself writing a sentence that could apply to any project, rewrite it with specific details from survey_data.
- Zero tolerance for placeholders. Any `[TODO]`, `TBD`, or template marker is a failure.
- Actor names are sacred. If the survey says "Developer", never write "Engineer", "Contributor", "Dev", or "User" when referring to that actor.
- Technology names are exact. If the survey says "PostgreSQL", never write "Postgres", "pg", or "PSQL".
- Decision citations are mandatory where applicable. If a section discusses a choice that has a DEC-XXX record, cite it.

**7. Return Protocol:**
After validation passes:
1. Write the document to `.banneker/documents/{DOCUMENT_TYPE}.md`
2. Report to architect: document type, file path, line count, any warnings from citation check
3. If validation fails and you cannot self-correct: report specific failures to architect so it can stop the pipeline
  </action>
  <verify>
Read the file and verify:
1. YAML frontmatter has name: banneker-writer and description field
2. Generation workflow has 3 phases: Planning, Generation, Self-Validation
3. All 10 document types have specific generation guidance (section mappings, tone, data mapping, likely citations)
4. Placeholder scan lists specific patterns to detect
5. Term consistency check references term_registry fields
6. Decision citation check verifies DEC-XXX IDs against decisions input
7. Quality rules section exists with zero-tolerance policy
8. Return protocol describes writing file and reporting to architect
9. File is at least 200 lines
  </verify>
  <done>banneker-writer.md agent exists at templates/agents/ with complete generation instructions for all 10 document types, self-validation rules, term registry enforcement, and decision citation requirements</done>
</task>

</tasks>

<verification>
1. `templates/agents/banneker-writer.md` exists with valid YAML frontmatter (name + description)
2. Writer agent covers all 10 document types with specific guidance
3. Writer self-validates against REQ-DOCS-003 (placeholders), REQ-DOCS-004 (consistency), REQ-DOCS-005 (citations)
4. Writer uses term_registry for all naming
5. Writer follows same markdown style as banneker-surveyor.md
6. Sample documents (.banneker/documents/*.md) can be used as quality reference
</verification>

<success_criteria>
- banneker-writer.md agent file has YAML frontmatter matching established pattern
- Writer generation workflow covers planning, generation, and self-validation phases
- All 10 document types have specific section mappings, tone guidance, data mapping, and likely citations
- Zero-placeholder quality rules are explicit and non-negotiable
- Term registry enforcement is detailed with specific examples of correct vs. incorrect naming
</success_criteria>

<output>
After completion, create `.planning/phases/04-document-generation/04-02-SUMMARY.md`
</output>
