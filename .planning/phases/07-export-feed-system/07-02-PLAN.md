---
phase: 07-export-feed-system
plan: 02
type: execute
wave: 2
depends_on: ["07-01"]
files_modified:
  - templates/commands/banneker-feed.md
  - templates/config/framework-adapters.md
autonomous: true

must_haves:
  truths:
    - "Running /banneker:feed triggers the export pipeline"
    - "Command checks prerequisites before spawning exporter agent"
    - "Command detects existing exports and offers resume"
    - "Command spawns banneker-exporter agent via Task tool"
    - "Command verifies output files exist after export"
    - "framework-adapters.md defines the 4 export format specifications"
  artifacts:
    - path: "templates/commands/banneker-feed.md"
      provides: "Command orchestrator for export lifecycle"
      min_lines: 80
      contains: "banneker-exporter"
    - path: "templates/config/framework-adapters.md"
      provides: "Export format specifications and configuration"
      min_lines: 40
      contains: "GSD"
  key_links:
    - from: "templates/commands/banneker-feed.md"
      to: "templates/agents/banneker-exporter.md"
      via: "Task tool spawning"
      pattern: "Task.*banneker-exporter"
    - from: "templates/commands/banneker-feed.md"
      to: ".banneker/survey.json"
      via: "prerequisite check"
      pattern: "survey\\.json"
    - from: "templates/commands/banneker-feed.md"
      to: "templates/config/framework-adapters.md"
      via: "references format specifications"
      pattern: "framework-adapters"
---

<objective>
Create the banneker-feed command orchestrator and framework-adapters config file. The command manages the export lifecycle (prerequisites, resume detection, agent spawning, output verification) following the established pattern from Phases 3-6. The config file defines the 4 export format specifications.

Purpose: The command orchestrator is the user-facing entry point (`/banneker:feed`). It follows the exact same Step 0-4 pattern established in banneker-survey, banneker-architect, banneker-roadmap, and banneker-appendix commands. The framework-adapters config provides format specifications referenced by both the command and the exporter agent.

Output: `templates/commands/banneker-feed.md` (command file) + `templates/config/framework-adapters.md` (config file)
</objective>

<execution_context>
@/home/daniel/.claude/get-shit-done/workflows/execute-plan.md
@/home/daniel/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Pattern references — existing command files
@templates/commands/banneker-appendix.md
@templates/commands/banneker-architect.md
@templates/commands/banneker-roadmap.md

# Agent file created in Plan 01
@.planning/phases/07-export-feed-system/07-01-SUMMARY.md

# Config pattern reference
@templates/config/document-catalog.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create framework-adapters config file</name>
  <files>templates/config/framework-adapters.md</files>
  <action>
Create `templates/config/framework-adapters.md` following the config file pattern established in Phase 4 (document-catalog.md). Config files have NO YAML frontmatter (unlike agent and command files — this is a key convention from decision 04-04).

**Structure:**

```markdown
# Framework Adapters

Configuration reference for Banneker export formats. Each adapter defines the target format, output location, and generation rules.

## GSD Adapter

**Target:** GSD (Get Shit Done) planning framework
**Output directory:** `.planning/`
**Files produced:**
- `PROJECT.md` — Project overview, value proposition, target users
- `REQUIREMENTS.md` — Categorized requirements with REQ-ID format
- `ROADMAP.md` — Dependency-ordered milestone plan

**Required source data:**
- `.banneker/survey.json` (required)
- `.banneker/architecture-decisions.json` (required)

**REQ-ID Format:** `REQ-[CATEGORY]-[NNN]`
**Categories:**
- INST: Installation & Distribution
- FUNC: Functional Requirements (from walkthroughs)
- DATA: Data Model & Backend
- UI: User Interface & Frontend
- SEC: Security
- PERF: Performance
- DOCS: Documentation

**Priority levels:** must, should, could
**Traceability:** Each requirement cites source survey field path

**Roadmap ordering:** Topological sort by dependency — infrastructure first, then auth/data, then core flows, then secondary flows, then polish.

## Platform Prompt Adapter

**Target:** Dense context document for AI platform consumption
**Output:** `.banneker/exports/platform-prompt.md`
**Word limit:** 4,000 words maximum
**Strategy:** Map-reduce summarization with section-aware truncation

**Required source data:**
- `.banneker/survey.json` (required)
- `.banneker/documents/*.md` (optional, enriches output)

**Sections (in order):**
1. Project Overview
2. Technology Stack
3. Architecture Decisions (key only)
4. Core Walkthroughs (condensed)
5. Requirements Summary

## Generic Summary Adapter

**Target:** Concatenated markdown of all planning documents
**Output:** `.banneker/exports/summary.md`
**Strategy:** Direct file concatenation with source comments

**Required source data:**
- `.banneker/documents/*.md` (at least one required)

**Document order:**
1. TECHNICAL-SUMMARY.md (first)
2. STACK.md (second)
3. INFRASTRUCTURE-ARCHITECTURE.md (third)
4. Remaining documents alphabetically

## Context Bundle Adapter

**Target:** Single-file LLM agent context artifact
**Output:** `.banneker/exports/context-bundle.md`
**Strategy:** Selective inclusion — prioritize quality over quantity

**Required source data:**
- `.banneker/survey.json` (required)
- `.banneker/architecture-decisions.json` (optional)
- `.banneker/documents/*.md` (optional)

**Inclusion priority:**
1. Survey data (as formatted JSON)
2. Architecture decisions (as formatted JSON)
3. TECHNICAL-SUMMARY.md (always if exists)
4. STACK.md (always if exists)
5. INFRASTRUCTURE-ARCHITECTURE.md (always if exists)
6. Other documents (only if they exist)
```

Adapt and expand this skeleton with project-specific detail. The file should be comprehensive enough that the exporter agent can reference it for format rules.
  </action>
  <verify>
1. File exists: `ls templates/config/framework-adapters.md`
2. Has NO YAML frontmatter (first line should NOT be `---`)
3. Contains all 4 adapter sections: grep for "GSD Adapter", "Platform Prompt Adapter", "Generic Summary Adapter", "Context Bundle Adapter"
4. Contains REQ-ID format definition: grep for `REQ-.*CATEGORY`
5. Contains category list: grep for "INST", "FUNC", "DATA"
6. Contains output paths: grep for `.planning/` and `.banneker/exports/`
7. Contains word limit: grep for "4,000"
  </verify>
  <done>
`templates/config/framework-adapters.md` exists without YAML frontmatter, defines all 4 export adapter specifications (GSD, platform prompt, generic summary, context bundle), includes REQ-ID format with categories, and specifies output paths and generation rules for each format.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create banneker-feed command orchestrator</name>
  <files>templates/commands/banneker-feed.md</files>
  <action>
Create `templates/commands/banneker-feed.md` following the established command orchestrator pattern from banneker-appendix.md and banneker-architect.md. Must have YAML frontmatter with `name` and `description` fields.

**YAML Frontmatter:**
```yaml
---
name: banneker-feed
description: "Export Banneker planning artifacts into downstream framework formats. Produces GSD planning files (.planning/), platform prompt, generic summary, and context bundle. Run after /banneker:architect to transform documents into consumable exports."
---
```

**Command Structure (follow established Step 0-4 pattern exactly):**

**Step 0: Prerequisite Check (MANDATORY)**

Check for required files before starting:

1. Check `.banneker/survey.json` exists — if missing, display "No survey data found at .banneker/survey.json" and "Run /banneker:survey first to conduct a discovery interview." then abort.

2. Check `.banneker/architecture-decisions.json` exists — if missing, display "No architecture decisions found" and "Run /banneker:survey first -- the decision gate phase creates this file." then abort.

3. Check `.banneker/documents/` directory has at least one .md file — if empty/missing, display warning "No documents found in .banneker/documents/. Run /banneker:architect first." but do NOT abort (GSD format can still be generated from survey data alone).

**Step 1: Resume Detection**

Check for existing export state and outputs:

1. Check `.banneker/state/export-state.md` — if exists with `status: interrupted`, offer to resume from last completed format.

2. Check for existing export outputs:
   - `.planning/PROJECT.md`, `.planning/REQUIREMENTS.md`, `.planning/ROADMAP.md` (GSD)
   - `.banneker/exports/platform-prompt.md`
   - `.banneker/exports/summary.md`
   - `.banneker/exports/context-bundle.md`

3. If all 4 format outputs exist, display "All exports already generated. Re-run to regenerate?" and wait for confirmation.

4. If some outputs exist, display which formats are complete and which need generation.

**Step 2: Directory Structure**

Create output directories if they don't exist:
- `.planning/` (likely already exists)
- `.banneker/exports/`

Write initial state file `.banneker/state/export-state.md`:
```markdown
# Export State
status: in_progress
started: {ISO date}
formats_requested: [gsd, platform_prompt, generic_summary, context_bundle]
formats_completed: []
```

**Step 3: Spawn Exporter Agent**

Use the Task tool to spawn `banneker-exporter` agent. Pass the following context in the task prompt:

- Which format(s) to generate (all 4 by default, or remaining if resuming)
- Path to survey.json
- Path to architecture-decisions.json
- Path to documents directory
- Reference to framework-adapters.md for format specifications

Spawn pattern (matching existing commands):
```
Use the Task tool to spawn the banneker-exporter agent.
Provide it with:
1. The format(s) to generate
2. The source data paths
3. Reference: @config/framework-adapters.md for format specs
```

**Step 4: Output Verification**

After agent completes, verify outputs exist:

**GSD format checks:**
- `.planning/PROJECT.md` exists and contains project name from survey
- `.planning/REQUIREMENTS.md` exists and contains at least one `REQ-` prefixed requirement
- `.planning/ROADMAP.md` exists and contains at least one phase/milestone

**Platform prompt checks:**
- `.banneker/exports/platform-prompt.md` exists
- Content is under 4,000 words (verify with word count)

**Generic summary checks:**
- `.banneker/exports/summary.md` exists
- Contains at least one `<!-- Source:` comment (proving concatenation happened)

**Context bundle checks:**
- `.banneker/exports/context-bundle.md` exists
- Contains survey data section

**State cleanup:**
- Update `.banneker/state/export-state.md` with `status: complete` and list of completed formats
- On verification failure, preserve state file for debugging (do NOT delete)

**Completion messaging (3 tiers matching appendix pattern):**
- Full (all 4 formats): "Export complete. Generated GSD planning files, platform prompt, generic summary, and context bundle."
- Partial (some formats): "Partial export complete. Generated {N} of 4 formats. Missing: {list}."
- Minimal (GSD only): "Minimal export complete. GSD planning files generated. Other formats require documents — run /banneker:architect first."

Display file paths and sizes for all generated exports.
  </action>
  <verify>
1. File exists: `ls templates/commands/banneker-feed.md`
2. Has valid YAML frontmatter: first line is `---`, contains `name: banneker-feed` and `description:`, closes with `---`
3. Contains Step 0-4 structure: grep for "Step 0", "Step 1", "Step 2", "Step 3", "Step 4"
4. References banneker-exporter agent: grep for "banneker-exporter"
5. Contains prerequisite checks: grep for "survey.json" and "architecture-decisions.json"
6. Contains resume detection: grep for "export-state.md" or "resume"
7. Contains output verification: grep for "PROJECT.md" and "REQUIREMENTS.md" and "ROADMAP.md"
8. Contains completion messaging: grep for "Export complete" or "Partial export"
  </verify>
  <done>
`templates/commands/banneker-feed.md` exists with valid YAML frontmatter, follows the Step 0-4 command orchestrator pattern, checks prerequisites (survey.json + architecture-decisions.json), detects resume conditions, spawns banneker-exporter agent via Task tool, verifies all 4 format outputs, and provides tiered completion messaging.
  </done>
</task>

</tasks>

<verification>
1. `templates/commands/banneker-feed.md` exists with YAML frontmatter (name + description)
2. `templates/config/framework-adapters.md` exists without YAML frontmatter
3. Command follows Step 0-4 pattern matching banneker-appendix.md and banneker-architect.md
4. Command references banneker-exporter agent for Task tool spawning
5. Config defines all 4 export format specifications
6. Command handles prerequisites, resume, spawning, verification, and completion messaging
</verification>

<success_criteria>
- banneker-feed.md is a well-structured command orchestrator following the established Step 0-4 pattern
- framework-adapters.md defines all 4 export format specs without YAML frontmatter
- Command checks survey.json and architecture-decisions.json as prerequisites
- Command spawns banneker-exporter via Task tool
- Command verifies all output files after export
- Resume detection handles interrupted and completed states
</success_criteria>

<output>
After completion, create `.planning/phases/07-export-feed-system/07-02-SUMMARY.md`
</output>
